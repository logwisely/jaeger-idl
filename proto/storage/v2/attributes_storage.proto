
syntax = "proto3";
import "storage/v2/trace_storage.proto";
package jaeger.storage.v2;
option go_package = "storage";

// Request object to get indexed attribute names.
// "Indexed" attributes are the most frequently used attributes in the trace data,
// which are often used/allowed for querying and filtering.
message GetIndexedAttributesNamesRequest {
  // Optional. The workspace ID to filter Operations.
  string workspace_id = 1;
  // service_name filters spans generated by a specific service.
  string service_name = 2;
  // Query parameters used to scope the suggestions.
  TraceQueryParameters query = 3;

  // Optional. Maximum number of names to return. If unset or <=0, the server chooses a default.
  int32 limit = 4;
}

// Response object to get attribute names.
message GetAttributesNamesResponse {
  repeated string names = 1;
}

// Request object to get top-K attribute values.
message GetTopKAttributeValuesRequest {
  // Optional. The workspace ID to filter Operations.
  string workspace_id = 1;
  // service_name filters spans generated by a specific service.
  string service_name = 2;
  // Query parameters used to scope the suggestions.
  TraceQueryParameters query = 3;

  // Required. The attribute name to fetch values for.
  string attribute_name = 4;

  // Optional. Number of values to return. If unset or <=0, the server chooses a default.
  int32 k = 5;
}

// Response object to get top-K attribute values.
message GetTopKAttributeValuesResponse {
  repeated string values = 1;
}

// Request object to get bottom-K attribute values.
message GetBottomKAttributeValuesRequest {
  // Optional. The workspace ID to filter Operations.
  string workspace_id = 1;
  // service_name filters spans generated by a specific service.
  string service_name = 2;
  // Query parameters used to scope the suggestions.
  TraceQueryParameters query = 3;

  // Required. The attribute name to fetch values for.
  string attribute_name = 4;

  // Optional. Number of values to return. If unset or <=0, the server chooses a default.
  int32 k = 5;
}

// Response object to get bottom-K attribute values.
message GetBottomKAttributeValuesResponse {
  repeated string values = 1;
}

service AttributesReader {
  rpc GetIndexedAttributesNames(GetIndexedAttributesNamesRequest) returns (GetAttributesNamesResponse) {}

  // GetTopKAttributeValues returns the most frequently observed values for an attribute.
  rpc GetTopKAttributeValues(GetTopKAttributeValuesRequest) returns (GetTopKAttributeValuesResponse) {}

  // GetBottomKAttributeValues returns the least frequently observed values for an attribute.
  rpc GetBottomKAttributeValues(GetBottomKAttributeValuesRequest) returns (GetBottomKAttributeValuesResponse) {}
}
