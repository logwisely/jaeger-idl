
syntax = "proto3";

import "google/protobuf/timestamp.proto";

package jaeger.storage.v2;
option go_package = "storage";

message AttributesQueryParameters {
  // Optional. The workspace ID to filter traces.
  string workspace_id = 1;
  string service_name = 2;
  string operation_name = 3;
  google.protobuf.Timestamp start_time_min = 4;
  google.protobuf.Timestamp start_time_max = 5;
  int32 limit = 6;
}

// Request object to get indexed attribute names.
// "Indexed" attributes are the most frequently used attributes in the trace data,
// which are often used/allowed for querying and filtering.
message GetIndexedAttributesNamesRequest {
  // Optional. The workspace ID to filter Operations.
  string workspace_id = 1;
  string service_name = 2;
  string operation_name = 3;
  AttributesQueryParameters query = 4;
}

// Response object to get attribute names.
message GetAttributesNamesResponse {
  repeated string names = 1;
}

// Request object to get top-K attribute values.
message GetTopKAttributeValuesRequest {
  string workspace_id = 1;
  string service_name = 2;
  string operation_name = 3;
  string attribute_name = 4;
  AttributesQueryParameters query = 5;
  // Optional. Number of values to return. If unset or <=0, the server chooses a default.
  int32 k = 6;
}

// Response object to get top-K attribute values.
message GetTopKAttributeValuesResponse {
  repeated string values = 1;
}

// Request object to get bottom-K attribute values.
message GetBottomKAttributeValuesRequest {
  string workspace_id = 1;
  string service_name = 2;
  string operation_name = 3;
  string attribute_name = 4;
  AttributesQueryParameters query = 5;
  // Optional. Number of values to return. If unset or <=0, the server chooses a default.
  int32 k = 6;
}

// Response object to get bottom-K attribute values.
message GetBottomKAttributeValuesResponse {
  repeated string values = 1;
}

service AttributesReader {
  rpc GetIndexedAttributesNames(GetIndexedAttributesNamesRequest) returns (GetAttributesNamesResponse) {}

  // GetTopKAttributeValues returns the most frequently observed values for an attribute.
  rpc GetTopKAttributeValues(GetTopKAttributeValuesRequest) returns (GetTopKAttributeValuesResponse) {}

  // GetBottomKAttributeValues returns the least frequently observed values for an attribute.
  rpc GetBottomKAttributeValues(GetBottomKAttributeValuesRequest) returns (GetBottomKAttributeValuesResponse) {}
}
